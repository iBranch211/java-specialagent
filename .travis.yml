# Copyright 2019 The OpenTracing Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

dist: trusty
language: java
cache:
  directories:
  - ~/.m2
before_install:
- 'export BUILD_PATH="$HOME/.m2/build/$TRAVIS_BUILD_ID" && mkdir -p $BUILD_PATH &&
   export MAVEN_OPTS="-Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn" &&
   export PURGE_EXCLUDE="io.opentracing.contrib.specialagent:opentracing-specialagent-util,io.opentracing.contrib.specialagent:opentracing-adapter" &&
   cp settings.xml $HOME/.m2/settings.xml;'
sudo: required
stages:
- install
- test
- deploy
jobs:
  include:
  - stage: install
    jdk: openjdk8
    install: rm -rf $BUILD_PATH ~/.m2/repository/io/opentracing/contrib/specialagent
    script:
    - 'if [ "$TRAVIS_BRANCH" = "master" ] &&
          [ "$TRAVIS_PULL_REQUEST" = "false" ]; then
        travis_retry bash -c "(mvn -B -P test --fail-at-end -Dsilent dependency:go-offline || true) && mvn -e -B -P report install || (rm -rf ~/.m2/repository/* && false)" &&
        travis_retry mvn -e -B -DrepoToken=$REPO_TOKEN coveralls:report &&
        travis_retry mvn -e -B -Dassemble install;
      else
        travis_retry bash -c "(mvn -B -P test --fail-at-end -Dsilent dependency:go-offline || true) && mvn -e -B install || (rm -rf ~/.m2/repository/* && false)" &&
        travis_retry mvn -e -B -Dassemble install;
      fi'
    before_cache: find . -name target -exec rsync -R -r '{}' $BUILD_PATH \;
  - stage: install
    jdk: openjdk11
    install: rm -rf $BUILD_PATH ~/.m2/repository/io/opentracing/contrib/specialagent
    script:
    - 'travis_retry bash -c "(mvn -e -B -P test --fail-at-end -Dsilent dependency:go-offline || true) && mvn -e -B install || (rm -rf ~/.m2/repository/* && false)" &&
       travis_retry mvn -e -B -Dassemble install;'
    before_cache: find . -name target -exec rsync -R -r '{}' $BUILD_PATH \;
  - stage: deploy
    jdk: openjdk8
    install: rsync -r $BUILD_PATH/ .
    script:
    - 'if [ "$TRAVIS_BRANCH" = "master" ] &&
          [ "$TRAVIS_PULL_REQUEST" = "false" ]; then
        eval "$SIGNING_KEY" &> /dev/null &&
        travis_retry mvn -e -B -Dassemble -P deploy deploy;
      fi'
  - name: "Akka Actor [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/akka-actor -amd integration-test || (mvn -e -B -P test -pl test/akka-actor -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Akka Actor [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/akka-actor -amd integration-test || (mvn -e -B -P test -pl test/akka-actor -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Akka Http [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/akka-http -amd integration-test || (mvn -e -B -P test -pl test/akka-http -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Akka Http [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/akka-http -amd integration-test || (mvn -e -B -P test -pl test/akka-http -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache CXF [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/cxf -amd integration-test || (mvn -e -B -P test -pl test/cxf -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache CXF [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/cxf -amd integration-test || (mvn -e -B -P test -pl test/cxf -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache HttpClient [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/apache-httpclient -amd integration-test || (mvn -e -B -P test -pl test/apache-httpclient -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache HttpClient [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/apache-httpclient -amd integration-test || (mvn -e -B -P test -pl test/apache-httpclient -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache Thrift [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/thrift -amd integration-test || (mvn -e -B -P test -pl test/thrift -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Apache Thrift [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/thrift -amd integration-test || (mvn -e -B -P test -pl test/thrift -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "AsyncHttpClient [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/asynchttpclient -amd integration-test || (mvn -e -B -P test -pl test/asynchttpclient -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "AsyncHttpClient [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/asynchttpclient -amd integration-test || (mvn -e -B -P test -pl test/asynchttpclient -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "AWS SDK [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/aws-sdk -amd integration-test || (mvn -e -B -P test -pl test/aws-sdk -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "AWS SDK [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/aws-sdk -amd integration-test || (mvn -e -B -P test -pl test/aws-sdk -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Cassandra Driver [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/cassandra-driver -amd integration-test || (mvn -e -B -P test -pl test/cassandra-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
#  - name: "Cassandra Driver [openjdk11]" # This is commented out, because Cassandra does not run ok jdk11
#    stage: test
#    jdk: openjdk11
#    install: true
#    script: travis_retry bash -c "mvn -e -B -P test -pl test/cassandra-driver -amd integration-test || (mvn -e -B -P test -pl test/cassandra-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Couchbase Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/couchbase-client -amd integration-test || (mvn -e -B -P test -pl test/couchbase-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Couchbase Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/couchbase-client -amd integration-test || (mvn -e -B -P test -pl test/couchbase-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Dubbo [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/dubbo -amd integration-test || (mvn -e -B -P test -pl test/dubbo -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Dubbo [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/dubbo -amd integration-test || (mvn -e -B -P test -pl test/dubbo -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Dynamic [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/dynamic -amd integration-test || (mvn -e -B -P test -pl test/dynamic -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Dynamic [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/dynamic -amd integration-test || (mvn -e -B -P test -pl test/dynamic -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Elasticsearch Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/elasticsearch-client -amd integration-test || (mvn -e -B -P test -pl test/elasticsearch-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Elasticsearch Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/elasticsearch-client -amd integration-test || (mvn -e -B -P test -pl test/elasticsearch-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Feign [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/feign -amd integration-test || (mvn -e -B -P test -pl test/feign -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Feign [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/feign -amd integration-test || (mvn -e -B -P test -pl test/feign -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Google Http Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/google-http-client -amd integration-test || (mvn -e -B -P test -pl test/google-http-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Google Http Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/google-http-client -amd integration-test || (mvn -e -B -P test -pl test/google-http-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Grizzly Http Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grizzly-http-client -amd integration-test || (mvn -e -B -P test -pl test/grizzly-http-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Grizzly Http Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grizzly-http-client -amd integration-test || (mvn -e -B -P test -pl test/grizzly-http-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Grizzly Http Server [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grizzly-http-server -amd integration-test || (mvn -e -B -P test -pl test/grizzly-http-server -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Grizzly Http Server [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grizzly-http-server -amd integration-test || (mvn -e -B -P test -pl test/grizzly-http-server -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "gRPC [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grpc -amd integration-test || (mvn -e -B -P test -pl test/grpc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "gRPC [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/grpc -amd integration-test || (mvn -e -B -P test -pl test/grpc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Hazelcast [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/hazelcast -amd integration-test || (mvn -e -B -P test -pl test/hazelcast -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Hazelcast [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/hazelcast -amd integration-test || (mvn -e -B -P test -pl test/hazelcast -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "HttpURLConnection [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/httpurlconnection -amd integration-test || (mvn -e -B -P test -pl test/httpurlconnection -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "HttpURLConnection [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/httpurlconnection -amd integration-test || (mvn -e -B -P test -pl test/httpurlconnection -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Hystrix [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/hystrix -amd integration-test || (mvn -e -B -P test -pl test/hystrix -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Hystrix [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/hystrix -amd integration-test || (mvn -e -B -P test -pl test/hystrix -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Concurrent API [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/concurrent -amd integration-test || (mvn -e -B -P test -pl test/concurrent -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Concurrent API [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/concurrent -amd integration-test || (mvn -e -B -P test -pl test/concurrent -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java JDBC API [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jdbc -amd integration-test || (mvn -e -B -P test -pl test/jdbc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java JDBC API [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jdbc -amd integration-test || (mvn -e -B -P test -pl test/jdbc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "JDBI [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jdbi -amd integration-test || (mvn -e -B -P test -pl test/jdbi -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "JDBI [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jdbi -amd integration-test || (mvn -e -B -P test -pl test/jdbi -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java JMS [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jms -amd integration-test || (mvn -e -B -P test -pl test/jms -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java JMS [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jms -amd integration-test || (mvn -e -B -P test -pl test/jms -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Servlet API: Jetty [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/servlet-jetty -amd integration-test || (mvn -e -B -P test -pl test/servlet-jetty -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Servlet API: Jetty [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/servlet-jetty -amd integration-test || (mvn -e -B -P test -pl test/servlet-jetty -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Servlet API: Tomcat [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/servlet-tomcat -amd integration-test || (mvn -e -B -P test -pl test/servlet-tomcat -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Java Servlet API: Tomcat [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/servlet-tomcat -amd integration-test || (mvn -e -B -P test -pl test/servlet-tomcat -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "JAX-RS Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jaxrs -amd integration-test || (mvn -e -B -P test -pl test/jaxrs -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "JAX-RS Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jaxrs -amd integration-test || (mvn -e -B -P test -pl test/jaxrs -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Jedis [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jedis -amd integration-test || (mvn -e -B -P test -pl test/jedis -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Jedis [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/jedis -amd integration-test || (mvn -e -B -P test -pl test/jedis -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Kafka Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/kafka-client -amd integration-test || (mvn -e -B -P test -pl test/kafka-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Kafka Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/kafka-client -amd integration-test || (mvn -e -B -P test -pl test/kafka-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Kafka Streams [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/kafka-streams -amd integration-test || (mvn -e -B -P test -pl test/kafka-streams -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Kafka Streams [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/kafka-streams -amd integration-test || (mvn -e -B -P test -pl test/kafka-streams -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Lettuce [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/lettuce -amd integration-test || (mvn -e -B -P test -pl test/lettuce -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Lettuce [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/lettuce -amd integration-test || (mvn -e -B -P test -pl test/lettuce -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver-async -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver-async -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver Async [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver-async -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver-async -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver Async [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver-reactive -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver-reactive -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver Reactive Streams [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver-reactive -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver-reactive -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "MongoDB Driver Reactive Streams [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mongo-driver -amd integration-test || (mvn -e -B -P test -pl test/mongo-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Mule 4 [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/mule -amd integration-test || (mvn -e -B -P test -pl test/mule -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
#  - name: "Mule 4 [openjdk11]" # This is commented out, because Mule 4 tests does not run on the openjdk11 ver on travis
#    stage: test
#    jdk: openjdk11
#    install: true
#    script: travis_retry bash -c "mvn -e -B -P test -pl test/mule -amd integration-test || (mvn -e -B -P test -pl test/mule -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Neo4j Driver [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/neo4j-driver -amd integration-test || (mvn -e -B -P test -pl test/neo4j-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Neo4j Driver [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/neo4j-driver -amd integration-test || (mvn -e -B -P test -pl test/neo4j-driver -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Netflix Zuul [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/zuul -amd integration-test || (mvn -e -B -P test -pl test/zuul -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Netflix Zuul [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/zuul -amd integration-test || (mvn -e -B -P test -pl test/zuul -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Netty [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/netty -amd integration-test || (mvn -e -B -P test -pl test/netty -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Netty [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/netty -amd integration-test || (mvn -e -B -P test -pl test/netty -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "OkHttp [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/okhttp -amd integration-test || (mvn -e -B -P test -pl test/okhttp -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "OkHttp [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/okhttp -amd integration-test || (mvn -e -B -P test -pl test/okhttp -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Play [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/play -amd integration-test || (mvn -e -B -P test -pl test/play -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Play [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/play -amd integration-test || (mvn -e -B -P test -pl test/play -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Play WS [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/play-ws -amd integration-test || (mvn -e -B -P test -pl test/play-ws -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Play WS [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/play-ws -amd integration-test || (mvn -e -B -P test -pl test/play-ws -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Pulsar Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/pulsar-client -amd integration-test || (mvn -e -B -P test -pl test/pulsar-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
#  - name: "Pulsar Client [openjdk11]" # This is commented out, because Pulsar does not run ok jdk11
#    stage: test
#    jdk: openjdk11
#    install: true
#    script: travis_retry bash -c "mvn -e -B -P test -pl test/pulsar-client -amd integration-test || (mvn -e -B -P test -pl test/pulsar-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Pulsar Functions [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/pulsar-functions -amd integration-test || (mvn -e -B -P test -pl test/pulsar-functions -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
#  - name: "Pulsar Functions [openjdk11]" # This is commented out, because Pulsar does not run ok jdk11
#    stage: test
#    jdk: openjdk11
#    install: true
#    script: travis_retry bash -c "mvn -e -B -P test -pl test/pulsar-functions -amd integration-test || (mvn -e -B -P test -pl test/pulsar-functions -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "RabbitMQ Client [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rabbitmq-client -amd integration-test || (mvn -e -B -P test -pl test/rabbitmq-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "RabbitMQ Client [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rabbitmq-client -amd integration-test || (mvn -e -B -P test -pl test/rabbitmq-client -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Ratpack [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/ratpack -amd integration-test || (mvn -e -B -P test -pl test/ratpack -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Ratpack [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/ratpack -amd integration-test || (mvn -e -B -P test -pl test/ratpack -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Reactor [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/reactor -amd integration-test || (mvn -e -B -P test -pl test/reactor -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Reactor [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/reactor -amd integration-test || (mvn -e -B -P test -pl test/reactor -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Redisson [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/redisson -amd integration-test || (mvn -e -B -P test -pl test/redisson -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Redisson [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/redisson -amd integration-test || (mvn -e -B -P test -pl test/redisson -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Rewrite [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rewrite -amd integration-test || (mvn -e -B -P test -pl test/rewrite -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Rewrite [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rewrite -amd integration-test || (mvn -e -B -P test -pl test/rewrite -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "RxJava [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rxjava -amd integration-test || (mvn -e -B -P test -pl test/rxjava -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "RxJava [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/rxjava -amd integration-test || (mvn -e -B -P test -pl test/rxjava -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "SparkJava [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/sparkjava -amd integration-test || (mvn -e -B -P test -pl test/sparkjava -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "SparkJava [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/sparkjava -amd integration-test || (mvn -e -B -P test -pl test/sparkjava -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Boot [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-boot -amd integration-test || (mvn -e -B -P test -pl test/spring-boot -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Boot [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-boot -amd integration-test || (mvn -e -B -P test -pl test/spring-boot -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Data [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-data -amd integration-test || (mvn -e -B -P test -pl test/spring-data -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Data [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-data -amd integration-test || (mvn -e -B -P test -pl test/spring-data -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring JMS [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-jms -amd integration-test || (mvn -e -B -P test -pl test/spring-jms -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring JMS [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-jms -amd integration-test || (mvn -e -B -P test -pl test/spring-jms -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Kafka [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-kafka -amd integration-test || (mvn -e -B -P test -pl test/spring-kafka -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Kafka [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-kafka -amd integration-test || (mvn -e -B -P test -pl test/spring-kafka -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Messaging [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-messaging -amd integration-test || (mvn -e -B -P test -pl test/spring-messaging -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Messaging [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-messaging -amd integration-test || (mvn -e -B -P test -pl test/spring-messaging -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring RabbitMQ [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-rabbitmq -amd integration-test || (mvn -e -B -P test -pl test/spring-rabbitmq -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring RabbitMQ [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-rabbitmq -amd integration-test || (mvn -e -B -P test -pl test/spring-rabbitmq -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Scheduling [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-scheduling -amd integration-test || (mvn -e -B -P test -pl test/spring-scheduling -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Scheduling [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-scheduling -amd integration-test || (mvn -e -B -P test -pl test/spring-scheduling -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Web [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-web -amd integration-test || (mvn -e -B -P test -pl test/spring-web -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Web [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-web -amd integration-test || (mvn -e -B -P test -pl test/spring-web -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Web MVC [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-webmvc -amd integration-test || (mvn -e -B -P test -pl test/spring-webmvc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring Web MVC [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-webmvc -amd integration-test || (mvn -e -B -P test -pl test/spring-webmvc -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring WebFlux [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-webflux -amd integration-test || (mvn -e -B -P test -pl test/spring-webflux -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring WebFlux [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-webflux -amd integration-test || (mvn -e -B -P test -pl test/spring-webflux -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring WebSocket [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-websocket -amd integration-test || (mvn -e -B -P test -pl test/spring-websocket -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spring WebSocket [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spring-websocket -amd integration-test || (mvn -e -B -P test -pl test/spring-websocket -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spymemcached [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spymemcached -amd integration-test || (mvn -e -B -P test -pl test/spymemcached -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Spymemcached [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/spymemcached -amd integration-test || (mvn -e -B -P test -pl test/spymemcached -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Twilio [openjdk8]"
    stage: test
    jdk: openjdk8
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/twilio -amd integration-test || (mvn -e -B -P test -pl test/twilio -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
  - name: "Twilio [openjdk11]"
    stage: test
    jdk: openjdk11
    install: true
    script: travis_retry bash -c "mvn -e -B -P test -pl test/twilio -amd integration-test || (mvn -e -B -P test -pl test/twilio -amd -Dexclude=$PURGE_EXCLUDE dependency:purge-local-repository && false)"
env:
  global:
